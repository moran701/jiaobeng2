local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/moran701/jiaobeng2/refs/heads/main/ui%E5%8A%A0%E8%BD%BD"))()

local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()

local LocalPlayer = game:GetService("Players").LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local camera = workspace.CurrentCamera
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

local function getDeviceType()
    local UserInputService = game:GetService("UserInputService")
    if UserInputService.TouchEnabled then
        if UserInputService.KeyboardEnabled then
            return "平板"
        else
            return "手机"
        end
    else
        return "电脑"
    end
end

local deviceType = getDeviceType()
local uiSize, uiPosition

if deviceType == "手机" then
    uiSize = UDim2.fromOffset(500, 400)
elseif deviceType == "平板" then
    uiSize = UDim2.fromOffset(550, 450)
else
    uiSize = UDim2.fromOffset(600, 500)
end
uiPosition = UDim2.new(0.5, 0, 0.5, 0)

WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local playerName = LocalPlayer.Name
local displayName = LocalPlayer.DisplayName

WindUI:Notify({
    Title = "陌染脚本",
    Content = "陌染脚本--死铁轨加载完成",
    Duration = 2
})

local Window = WindUI:CreateWindow({
    Title = "陌染脚本--死铁轨",
    Icon = "crown",
    Author = "作者：陌染",
    Folder = "OrangeCHub",
    Size = uiSize,
    Position = uiPosition,
    Theme = "Dark",
    Transparent = true,
    User = {
        Enabled = true,
        Anonymous = false,
        Username = playerName,
        DisplayName = displayName,
        UserId = LocalPlayer.UserId,
        ThumbnailType = "AvatarBust",
        Callback = function()
            WindUI:Notify({
                Title = "用户信息",
                Content = "玩家:" .. LocalPlayer.Name,
                Duration = 3
            })
        end
    },
    SideBarWidth = deviceType == "手机" and 150 or 180,
    ScrollBarEnabled = true
})

Window:CreateTopbarButton("theme-switcher", "moon", function()
    WindUI:SetTheme(WindUI:GetCurrentTheme() == "Dark" and "Light" or "Dark")
    WindUI:Notify({
        Title = "提示",
        Content = "当前主题: "..WindUI:GetCurrentTheme(),
        Duration = 2
    })
end, 990)

Window:EditOpenButton({
    Title = "陌染脚本--死铁轨",
    Icon = "crown",
})

Window:SetToggleKey(Enum.KeyCode.N)

local Tabs = {
    Pl = Window:Section({ Title = "玩家", Opened = false, Icon = "user"}),
    Block = Window:Section({ Title = "功能", Opened = false, Icon = "hand-fist"}),
}

local TabHandles = {
    Announcement = Tabs.Pl:Tab({ Title = "公告", Icon = "folder"}),
    Player = Tabs.Pl:Tab({ Title = "玩家", Icon = "folder"}),
    Block1 = Tabs.Block:Tab({ Title = "绘制", Icon = "folder"}),
    Block2 = Tabs.Block:Tab({ Title = "其它", Icon = "folder"}),
}

TabHandles.Announcement:Paragraph({
    Title = "欢迎尊贵的用户",
    Desc = "此脚本会一直更新 感谢白名单使用者",
    Image = "info",
    ImageSize = 15
})

TabHandles.Announcement:Paragraph({
    Title = "玩家",
    Desc = "尊敬的用户: " .. LocalPlayer.Name .. "欢迎使用",
    Image = "user",
    ImageSize = 12
})

TabHandles.Announcement:Paragraph({
    Title = "设备",
    Desc = "你的使用设备: " .. deviceType,
    Image = "gamepad",
    ImageSize = 12
})

TabHandles.Announcement:Paragraph({
    Title = "设备",
    Desc = "你的注入器: " .. identifyexecutor(),
    Image = "syringe",
    ImageSize = 12
})

TabHandles.Block1:Toggle({
    Title = "所有",
    Desc = "绘制",
    Value = false,
    Callback = function(state)
        if state then
            -- 开启高亮
            for _, item in workspace:WaitForChild("RuntimeItems"):GetChildren() do
                if not item:IsA("BasePart") and not item:IsA("Model") then
                    continue -- 跳过非可视对象
                end
                
                -- 先检查是否已存在高亮，避免重复创建
                local existingHighlight = item:FindFirstChildOfClass("Highlight")
                if existingHighlight then
                    existingHighlight:Destroy()
                end
                
                local existingBillboard = item:FindFirstChildOfClass("BillboardGui")
                if existingBillboard then
                    existingBillboard:Destroy()
                end
                
                -- 创建高亮效果
                local highlight = Instance.new("Highlight")
                highlight.Name = "ItemHighlighter"
                highlight.FillColor = Color3.new(0, 143, 156)
                highlight.FillTransparency = 0
                highlight.OutlineColor = Color3.new(1, 1, 1)
                highlight.OutlineTransparency = 0
                highlight.Parent = item
                
                -- 创建文字显示
                local billboardGui = Instance.new("BillboardGui")
                billboardGui.Name = "ItemLabel"
                billboardGui.Adornee = item
                billboardGui.Size = UDim2.new(0, 200, 0, 50)
                billboardGui.StudsOffset = Vector3.new(0, 3, 0)
                billboardGui.AlwaysOnTop = true
                billboardGui.MaxDistance = 100  -- 限制显示距离，提升性能
                
                local textLabel = Instance.new("TextLabel")
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = item.Name
                textLabel.TextColor3 = Color3.new(0, 143, 156)
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.TextStrokeTransparency = 0.5  -- 添加描边，提高可读性
                textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
                textLabel.Parent = billboardGui
                
                billboardGui.Parent = item
            end
        else
            -- 关闭高亮
            for _, item in workspace:WaitForChild("RuntimeItems"):GetChildren() do
                -- 安全移除高亮效果
                local highlight = item:FindFirstChildOfClass("Highlight")
                if highlight then
                    highlight:Destroy()
                end
                
                -- 安全移除BillboardGui
                local billboardGui = item:FindFirstChildOfClass("BillboardGui")
                if billboardGui then
                    billboardGui:Destroy()
                end
            end
        end
    end
})

TabHandles.Block1:Toggle({
    Title = "透视金条",
    Desc = "绘制",
    Value = false,
    Callback = function(state)
        if state then
            -- 开启高亮
            for _, jingtiao in workspace.RuntimeItems.GoldBar:GetChildren() do
                -- 创建高亮效果
                local h = Instance.new("Highlight")
                h.FillColor = Color3.new(0, 143, 156)
                h.FillTransparency = 0
                h.Parent = jingtiao  -- 修正：使用正确的变量名
                
                -- 创建文字显示
                local billboardGui = Instance.new("BillboardGui")
                local textLabel = Instance.new("TextLabel")
                
                -- 设置BillboardGui
                billboardGui.Adornee = jingtiao
                billboardGui.Size = UDim2.new(0, 200, 0, 50)
                billboardGui.StudsOffset = Vector3.new(0, 3, 0)
                billboardGui.AlwaysOnTop = true
                
                -- 设置TextLabel
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "金条"
                textLabel.TextColor3 = Color3.new(0, 143, 156)
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboardGui
                
                billboardGui.Parent = jingtiao
            end
        else
            -- 关闭高亮
            for _, jingtiao in workspace.RuntimeItems.GoldBar:GetChildren() do
                -- 移除高亮效果
                local highlight = jingtiao:FindFirstChildOfClass("Highlight")
                if highlight then
                    highlight:Destroy()
                end
                
                -- 移除BillboardGui
                local billboardGui = jingtiao:FindFirstChildOfClass("BillboardGui")
                if billboardGui then
                    billboardGui:Destroy()
                end
            end
        end
    end
})

TabHandles.Block1:Toggle({
    Title = "透视银条",
    Desc = "绘制",
    Value = false,
    Callback = function(state)
        if state then
            for _, SilverBar in workspace.RuntimeItems.SilverBar:GetChildren() do
                local h = Instance.new("Highlight")
                h.FillColor = Color3.new(0, 143, 156)
                h.FillTransparency = 0
                h.Parent = SilverBar
                
                local billboardGui = Instance.new("BillboardGui")
                local textLabel = Instance.new("TextLabel")
                
                billboardGui.Adornee = SilverBar
                billboardGui.Size = UDim2.new(0, 200, 0, 50)
                billboardGui.StudsOffset = Vector3.new(0, 3, 0)
                billboardGui.AlwaysOnTop = true
                
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "银条"
                textLabel.TextColor3 = Color3.new(0, 143, 156)
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboardGui
                
                billboardGui.Parent = SilverBar
            end
        else
            for _, SilverBar in workspace.RuntimeItems.SilverBar:GetChildren() do
                local highlight = SilverBar:FindFirstChildOfClass("Highlight")
                if highlight then
                    highlight:Destroy()
                end
                
                local billboardGui = SilverBar:FindFirstChildOfClass("BillboardGui")
                if billboardGui then
                    billboardGui:Destroy()
                end
            end
        end
    end
})

TabHandles.Block2:Button({
	Title = "自动债券",
	Icon = "其它",
	Callback = function()
	loadstring(game:HttpGet('https://pastebin.com/raw/wEbPmysL'))()
end
})

TabHandles.Player:Toggle({
    Title = "夜视",
    Desc = "开启/关闭夜视效果",
    Value = false,
    Callback = function(state)
        if state then
            game.Lighting.Ambient = Color3.new(1, 1, 1)
        else
            game.Lighting.Ambient = Color3.new(0, 0, 0)
        end
    end
})

-- 穿墙功能
local Noclip = false
local Stepped = nil

TabHandles.Player:Toggle({
    Title = "穿墙",
    Desc = "开启/关闭穿墙模式",
    Value = false,
    Callback = function(state)
        if state then
            Noclip = true
            Stepped = game:GetService("RunService").Stepped:Connect(function()
                if Noclip == true then
                    for _, b in pairs(game.Workspace:GetChildren()) do
                        if b.Name == game.Players.LocalPlayer.Name then
                            for _, v in pairs(game.Workspace[game.Players.LocalPlayer.Name]:GetChildren()) do
                                if v:IsA("BasePart") then
                                    v.CanCollide = false
                                end
                            end
                        end
                    end
                else
                    Stepped:Disconnect()
                end
            end)
        else
            Noclip = false
            if Stepped then
                Stepped:Disconnect()
                Stepped = nil
            end
        end
    end
})

local Item = nil
local M = 50
local GetItem = false

TabHandles.Player:Dropdown({
    Title = "物品下拉菜单",
    Desc = "收集物品",
    Values = {'金条', '银条', '煤炭'}, -- 这里需要添加所有选项
    Value = "选择",
    Multi = false,
    AllowNone = false,
    Callback = function(value)
        local GetItemList = { 
            ['金条'] = 'GoldBar',
            ['银条'] = 'SilverBar',
            ['煤炭'] = 'Coal',
        }
        Item = GetItemList[value]
    end
})

TabHandles.Player:Slider({
    Title = "范围",
    Desc = "收集范围",
    Step = 1,
    Value = {
        Min = 0,
        Max = 200,
        Default = 50,
    },
    Callback = function(value)
        M = tonumber(value)
    end
})

TabHandles.Player:Toggle({
    Title = "自动收集",
    Desc = "收集",
    Value = false,
    Callback = function(state) 
        GetItem = state
        if state then
            while GetItem do
                for _, v in pairs(workspace.RuntimeItems:GetChildren()) do
                    if v.Name == Item and (game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart").Position - v:GetPivot().Position).Magnitude <= M then
                        game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("StoreItem"):FireServer(v)       
                    end
                end
                task.wait(0.1)
            end
        end
    end
})